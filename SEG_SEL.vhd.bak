ENTITY SEG_SEL IS
PORT( D_SEG:OUT BIT_VECTOR(3 DOWNTO 0);
		D_POS:OUT BIT_VECTOR(7 downto 0);
		CLK:IN BIT;
		DATA_IN:IN BIT_VECTOR(7 DOWNTO 0)
		);
END SEG_SEL;

ARCHITECTURE behave OF SEG_SEL IS
CONSTANT TEMP:INTEGER:=1234;
SIGNAL A,B,C,D:BIT_VECTOR(3 DOWNTO 0):="0000";
SIGNAL DATA:BIT_VECTOR(15 DOWNTO 0);
SIGNAL CLK_1KHz:BIT;
BEGIN


	PROCESS(DATA_IN,CLK)
	BEGIN
		IF(CLK'EVENT AND CLK='1')THEN
			case DATA_IN(5 DOWNTO 4) is
				when "00" => A <=DATA_IN(3 DOWNTO 0); B<=B;C<=C;D<=D;
				when "01" => B <=DATA_IN(3 DOWNTO 0); A<=A;C<=C;D<=D;
				when "10" => C <=DATA_IN(3 DOWNTO 0); A<=A;B<=B;D<=D;
				when "11" => D <=DATA_IN(3 DOWNTO 0); A<=A;B<=B;C<=C;
			when others =>A<=A;B<=B;C<=C;D<=D;
			end case;
		END IF;
	END PROCESS;

	PROCESS(CLK)
	VARIABLE TMP:INTEGER RANGE 0 TO 5000;
	BEGIN
	IF (CLK'EVENT AND CLK = '1') THEN TMP:=TMP+1;
		IF (TMP < 2500) THEN CLK_1KHz <= '1';
		ELSIF (TMP = 5000) THEN TMP:= 0;
		ELSE CLK_1KHz <= '0';
		END IF;
	END IF;
	END PROCESS;
	
	
	PROCESS(CLK_1KHz)
	VARIABLE CNT:INTEGER RANGE 0 TO 3;
		BEGIN
			IF(CLK_1KHz'EVENT AND CLK_1KHz='1')THEN
				CNT:=CNT+1;
			END IF;
		
			case CNT is
				when 0 => D_SEG<=A;D_POS<="01111111";
				when 1 => D_SEG<=B;D_POS<="10111111";
				when 2 => D_SEG<=C;D_POS<="11011111";
				when 3 => D_SEG<=D;D_POS<="11101111";
				WHEN OTHERS => NULL;
			end case;
		END PROCESS;
	
END behave;
		